/**
 * @file lookup_table.c
 * @brief Implementation of ASCII to Binary lookup table
 */

#include "lookup_table.h"
#include <string.h>

/* ASCII to Binary lookup table */
static const LookupEntry lookup_table[] = {
    {"0000000", {'\0', '\0'}},      // NUL
    {"0000001", {'\x01', '\0'}},    // SOH
    {"0000010", {'\x02', '\0'}},    // STX
    {"0000011", {'\x03', '\0'}},    // ETX
    {"0000100", {'\x04', '\0'}},    // EOT
    {"0000101", {'\x05', '\0'}},    // ENQ
    {"0000110", {'\x06', '\0'}},    // ACK
    {"0000111", {'\a', '\0'}},      // BEL
    {"0001000", {'\b', '\0'}},      // BS
    {"0001001", {'\t', '\0'}},      // TAB
    {"0001010", {'\n', '\0'}},      // LF
    {"0001011", {'\v', '\0'}},      // VT
    {"0001100", {'\f', '\0'}},      // FF
    {"0001101", {'\r', '\0'}},      // CR
    {"0001110", {'\x0E', '\0'}},    // SO
    {"0001111", {'\x0F', '\0'}},    // SI
    {"0010000", {'\x10', '\0'}},    // DLE
    {"0010001", {'\x11', '\0'}},    // DC1
    {"0010010", {'\x12', '\0'}},    // DC2
    {"0010011", {'\x13', '\0'}},    // DC3
    {"0010100", {'\x14', '\0'}},    // DC4
    {"0010101", {'\x15', '\0'}},    // NAK
    {"0010110", {'\x16', '\0'}},    // SYN
    {"0010111", {'\x17', '\0'}},    // ETB
    {"0011000", {'\x18', '\0'}},    // CAN
    {"0011001", {'\x19', '\0'}},    // EM
    {"0011010", {'\x1A', '\0'}},    // SUB
    {"0011011", {'\x1B', '\0'}},    // ESC
    {"0011100", {'\x1C', '\0'}},    // FS
    {"0011101", {'\x1D', '\0'}},    // GS
    {"0011110", {'\x1E', '\0'}},    // RS
    {"0011111", {'\x1F', '\0'}},    // US
    {"0100000", {' ', '\0'}},       // (space)
    {"0100001", {'!', '\0'}},
    {"0100010", {'"', '\0'}},
    {"0100011", {'#', '\0'}},
    {"0100100", {'$', '\0'}},
    {"0100101", {'%', '\0'}},
    {"0100110", {'&', '\0'}},
    {"0100111", {'\'', '\0'}},
    {"0101000", {'(', '\0'}},
    {"0101001", {')', '\0'}},
    {"0101010", {'*', '\0'}},
    {"0101011", {'+', '\0'}},
    {"0101100", {',', '\0'}},
    {"0101101", {'-', '\0'}},
    {"0101110", {'.', '\0'}},
    {"0101111", {'/', '\0'}},
    {"0110000", {'0', '\0'}},
    {"0110001", {'1', '\0'}},
    {"0110010", {'2', '\0'}},
    {"0110011", {'3', '\0'}},
    {"0110100", {'4', '\0'}},
    {"0110101", {'5', '\0'}},
    {"0110110", {'6', '\0'}},
    {"0110111", {'7', '\0'}},
    {"0111000", {'8', '\0'}},
    {"0111001", {'9', '\0'}},
    {"0111010", {':', '\0'}},
    {"0111011", {';', '\0'}},
    {"0111100", {'<', '\0'}},
    {"0111101", {'=', '\0'}},
    {"0111110", {'>', '\0'}},
    {"0111111", {'?', '\0'}},
    {"1000000", {'@', '\0'}},
    {"1000001", {'A', '\0'}},
    {"1000010", {'B', '\0'}},
    {"1000011", {'C', '\0'}},
    {"1000100", {'D', '\0'}},
    {"1000101", {'E', '\0'}},
    {"1000110", {'F', '\0'}},
    {"1000111", {'G', '\0'}},
    {"1001000", {'H', '\0'}},
    {"1001001", {'I', '\0'}},
    {"1001010", {'J', '\0'}},
    {"1001011", {'K', '\0'}},
    {"1001100", {'L', '\0'}},
    {"1001101", {'M', '\0'}},
    {"1001110", {'N', '\0'}},
    {"1001111", {'O', '\0'}},
    {"1010000", {'P', '\0'}},
    {"1010001", {'Q', '\0'}},
    {"1010010", {'R', '\0'}},
    {"1010011", {'S', '\0'}},
    {"1010100", {'T', '\0'}},
    {"1010101", {'U', '\0'}},
    {"1010110", {'V', '\0'}},
    {"1010111", {'W', '\0'}},
    {"1011000", {'X', '\0'}},
    {"1011001", {'Y', '\0'}},
    {"1011010", {'Z', '\0'}},
    {"1011011", {'[', '\0'}},
    {"1011100", {'\\', '\0'}},
    {"1011101", {']', '\0'}},
    {"1011110", {'^', '\0'}},
    {"1011111", {'_', '\0'}},
    {"1100000", {'`', '\0'}},
    {"1100001", {'a', '\0'}},
    {"1100010", {'b', '\0'}},
    {"1100011", {'c', '\0'}},
    {"1100100", {'d', '\0'}},
    {"1100101", {'e', '\0'}},
    {"1100110", {'f', '\0'}},
    {"1100111", {'g', '\0'}},
    {"1101000", {'h', '\0'}},
    {"1101001", {'i', '\0'}},
    {"1101010", {'j', '\0'}},
    {"1101011", {'k', '\0'}},
    {"1101100", {'l', '\0'}},
    {"1101101", {'m', '\0'}},
    {"1101110", {'n', '\0'}},
    {"1101111", {'o', '\0'}},
    {"1110000", {'p', '\0'}},
    {"1110001", {'q', '\0'}},
    {"1110010", {'r', '\0'}},
    {"1110011", {'s', '\0'}},
    {"1110100", {'t', '\0'}},
    {"1110101", {'u', '\0'}},
    {"1110110", {'v', '\0'}},
    {"1110111", {'w', '\0'}},
    {"1111000", {'x', '\0'}},
    {"1111001", {'y', '\0'}},
    {"1111010", {'z', '\0'}},
    {"1111011", {'{', '\0'}},
    {"1111100", {'|', '\0'}},
    {"1111101", {'}', '\0'}},
    {"1111110", {'~', '\0'}},
    {"1111111", {'\x7F', '\0'}}  // DEL
};

size_t get_lookup_table_size(void) {
    return sizeof(lookup_table) / sizeof(LookupEntry);
}

const LookupEntry* get_lookup_table(void) {
    return lookup_table;
}

int find_ascii_in_table(char ascii_char, char* binary_buffer) {
    if (binary_buffer == NULL) {
        return 0;
    }
    
    const size_t table_size = get_lookup_table_size();
    const LookupEntry* table = get_lookup_table();
    
    for (size_t i = 0; i < table_size; i++) {
        if (table[i].ascii[0] == ascii_char) {
            strcpy(binary_buffer, table[i].binary);
            return 1;
        }
    }
    
    return 0;
}

int find_binary_in_table(const char* binary_string, char* ascii_char) {
    if (binary_string == NULL || ascii_char == NULL) {
        return 0;
    }
    
    const size_t table_size = get_lookup_table_size();
    const LookupEntry* table = get_lookup_table();
    
    for (size_t i = 0; i < table_size; i++) {
        if (strcmp(table[i].binary, binary_string) == 0) {
            *ascii_char = table[i].ascii[0];
            return 1;
        }
    }
    
    return 0;
} 
